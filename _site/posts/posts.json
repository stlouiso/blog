[
  {
    "path": "posts/2021-06-18-customer-segmentationwith-mlb-players/",
    "title": "Customer Segmentation...with MLB players Pt. 1",
    "description": "Many businesses try to create customer segmentation to gain a greater understanding of their customer base. This post will show how this can be done from start to finish and how to interpret and validate the newly found segments. Throughout this example advice on how to do this with retail data is given.",
    "author": [
      {
        "name": "Louis Oberdiear",
        "url": "thelob.blog/louisoberdiear"
      }
    ],
    "date": "2021-06-18",
    "categories": [
      "customer segmentation",
      "cluster analysis",
      "data science",
      "rstats"
    ],
    "contents": "\r\nCustomer Segmentation of MLB Baseball Players\r\nThe goal of customer segmentation is to find hidden groups in data. The customer in this example will be MLB hitters. We are going to be coming at this problem as if we don’t know anything about MLB hitters to understand the different types of hitters utilizing different clustering algorithms.\r\nThe Data\r\nFor customer segmentation, you need data that describes the customer. In retail, this could be how recently they have made a purchase, how many times they have purchased in the last 12 months, and the total amount of money they have spent in the last 12 months. These describe a customer’s shopping behavior. You could include age and some other area demographics like Zip Code Household Income and Household size. You just need relevant data that describes the customer.\r\nIn this example, we need to get data that describes MLB hitters. We are going to use data from 2018 for the following:\r\nTotal At Bats\r\nWalks\r\nStrikeouts\r\nSingles\r\nDoubles\r\nTriples\r\nHome Runs\r\nThe reason for these specific data points is because they are the outcomes of an at-bat. This could be applied to retail settings also. The number of times a person visits your site, time spent browsing the site, products looked at, the number of products added to the cart, and the number of products purchased.\r\nWe can find the data in the R package ‘Lahman’ which is from Sean Lahman’s baseball database. More info can be found here: www.seanlahman.com\r\nInstall the package:\r\n\r\n\r\ninstall.packages(\"Lahman\")\r\n\r\n\r\n\r\n\r\n\r\nlibrary(Lahman)\r\nlibrary(gt)\r\ndata(Batting)\r\nhead(Batting) %>%\r\n  gt()\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#kdmqacevir .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 16px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#kdmqacevir .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#kdmqacevir .gt_title {\r\n  color: #333333;\r\n  font-size: 125%;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#kdmqacevir .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 85%;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#kdmqacevir .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#kdmqacevir .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#kdmqacevir .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#kdmqacevir .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#kdmqacevir .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#kdmqacevir .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#kdmqacevir .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#kdmqacevir .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#kdmqacevir .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#kdmqacevir .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#kdmqacevir .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#kdmqacevir .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#kdmqacevir .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#kdmqacevir .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#kdmqacevir .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#kdmqacevir .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#kdmqacevir .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#kdmqacevir .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#kdmqacevir .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#kdmqacevir .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#kdmqacevir .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#kdmqacevir .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#kdmqacevir .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#kdmqacevir .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#kdmqacevir .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#kdmqacevir .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#kdmqacevir .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#kdmqacevir .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#kdmqacevir .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#kdmqacevir .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#kdmqacevir .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nplayerID\r\n      yearID\r\n      stint\r\n      teamID\r\n      lgID\r\n      G\r\n      AB\r\n      R\r\n      H\r\n      X2B\r\n      X3B\r\n      HR\r\n      RBI\r\n      SB\r\n      CS\r\n      BB\r\n      SO\r\n      IBB\r\n      HBP\r\n      SH\r\n      SF\r\n      GIDP\r\n    abercda01\r\n1871\r\n1\r\nTRO\r\nNA\r\n1\r\n4\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\nNA\r\nNA\r\nNA\r\nNA\r\n0addybo01\r\n1871\r\n1\r\nRC1\r\nNA\r\n25\r\n118\r\n30\r\n32\r\n6\r\n0\r\n0\r\n13\r\n8\r\n1\r\n4\r\n0\r\nNA\r\nNA\r\nNA\r\nNA\r\n0allisar01\r\n1871\r\n1\r\nCL1\r\nNA\r\n29\r\n137\r\n28\r\n40\r\n4\r\n5\r\n0\r\n19\r\n3\r\n1\r\n2\r\n5\r\nNA\r\nNA\r\nNA\r\nNA\r\n1allisdo01\r\n1871\r\n1\r\nWS3\r\nNA\r\n27\r\n133\r\n28\r\n44\r\n10\r\n2\r\n2\r\n27\r\n1\r\n1\r\n0\r\n2\r\nNA\r\nNA\r\nNA\r\nNA\r\n0ansonca01\r\n1871\r\n1\r\nRC1\r\nNA\r\n25\r\n120\r\n29\r\n39\r\n11\r\n3\r\n0\r\n16\r\n6\r\n2\r\n2\r\n1\r\nNA\r\nNA\r\nNA\r\nNA\r\n0armstbo01\r\n1871\r\n1\r\nFW1\r\nNA\r\n12\r\n49\r\n9\r\n11\r\n2\r\n1\r\n0\r\n5\r\n0\r\n1\r\n0\r\n1\r\nNA\r\nNA\r\nNA\r\nNA\r\n0\r\n\r\nGlimpse the data:\r\n\r\n\r\nlibrary(dplyr)\r\nglimpse(Batting)\r\n\r\n\r\nRows: 108,789\r\nColumns: 22\r\n$ playerID <chr> \"abercda01\", \"addybo01\", \"allisar01\", \"allisdo01\", ~\r\n$ yearID   <int> 1871, 1871, 1871, 1871, 1871, 1871, 1871, 1871, 187~\r\n$ stint    <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ~\r\n$ teamID   <fct> TRO, RC1, CL1, WS3, RC1, FW1, RC1, BS1, FW1, BS1, C~\r\n$ lgID     <fct> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,~\r\n$ G        <int> 1, 25, 29, 27, 25, 12, 1, 31, 1, 18, 22, 1, 10, 3, ~\r\n$ AB       <int> 4, 118, 137, 133, 120, 49, 4, 157, 5, 86, 89, 3, 36~\r\n$ R        <int> 0, 30, 28, 28, 29, 9, 0, 66, 1, 13, 18, 0, 6, 7, 24~\r\n$ H        <int> 0, 32, 40, 44, 39, 11, 1, 63, 1, 13, 27, 0, 7, 6, 3~\r\n$ X2B      <int> 0, 6, 4, 10, 11, 2, 0, 10, 1, 2, 1, 0, 0, 0, 9, 3, ~\r\n$ X3B      <int> 0, 0, 5, 2, 3, 1, 0, 9, 0, 1, 10, 0, 0, 0, 1, 3, 0,~\r\n$ HR       <int> 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 1, 0, 0, ~\r\n$ RBI      <int> 0, 13, 19, 27, 16, 5, 2, 34, 1, 11, 18, 0, 1, 5, 21~\r\n$ SB       <int> 0, 8, 3, 1, 6, 0, 0, 11, 0, 1, 0, 0, 2, 2, 4, 4, 0,~\r\n$ CS       <int> 0, 1, 1, 1, 2, 1, 0, 6, 0, 0, 1, 0, 0, 0, 0, 4, 0, ~\r\n$ BB       <int> 0, 4, 2, 0, 2, 0, 1, 13, 0, 0, 3, 1, 2, 0, 2, 9, 0,~\r\n$ SO       <int> 0, 0, 5, 2, 1, 1, 0, 1, 0, 0, 4, 0, 0, 0, 2, 2, 3, ~\r\n$ IBB      <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,~\r\n$ HBP      <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,~\r\n$ SH       <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,~\r\n$ SF       <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,~\r\n$ GIDP     <int> 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 0, 1, 2, 0, ~\r\n\r\nWe only want data from 2018 so we need to filter down and select the data points we want:\r\n\r\n\r\nbatting_2018 <- Batting %>%\r\n  filter(yearID == 2018) %>%\r\n  select(c(playerID, teamID, lgID, G, AB, SH, SF, BB, HBP, IBB, SO, H, X2B, X3B, HR))\r\nhead(batting_2018) %>% gt()\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#fmrtpxxrfp .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 16px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#fmrtpxxrfp .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#fmrtpxxrfp .gt_title {\r\n  color: #333333;\r\n  font-size: 125%;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#fmrtpxxrfp .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 85%;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#fmrtpxxrfp .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#fmrtpxxrfp .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#fmrtpxxrfp .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#fmrtpxxrfp .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#fmrtpxxrfp .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#fmrtpxxrfp .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#fmrtpxxrfp .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#fmrtpxxrfp .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#fmrtpxxrfp .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#fmrtpxxrfp .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#fmrtpxxrfp .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#fmrtpxxrfp .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#fmrtpxxrfp .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#fmrtpxxrfp .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#fmrtpxxrfp .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#fmrtpxxrfp .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#fmrtpxxrfp .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#fmrtpxxrfp .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#fmrtpxxrfp .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#fmrtpxxrfp .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#fmrtpxxrfp .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#fmrtpxxrfp .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#fmrtpxxrfp .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#fmrtpxxrfp .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#fmrtpxxrfp .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#fmrtpxxrfp .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#fmrtpxxrfp .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#fmrtpxxrfp .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#fmrtpxxrfp .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#fmrtpxxrfp .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#fmrtpxxrfp .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nplayerID\r\n      teamID\r\n      lgID\r\n      G\r\n      AB\r\n      SH\r\n      SF\r\n      BB\r\n      HBP\r\n      IBB\r\n      SO\r\n      H\r\n      X2B\r\n      X3B\r\n      HR\r\n    abreujo02\r\nCHA\r\nAL\r\n128\r\n499\r\n0\r\n6\r\n37\r\n11\r\n7\r\n109\r\n132\r\n36\r\n1\r\n22acunaro01\r\nATL\r\nNL\r\n111\r\n433\r\n0\r\n3\r\n45\r\n6\r\n2\r\n123\r\n127\r\n26\r\n4\r\n26adamewi01\r\nTBA\r\nAL\r\n85\r\n288\r\n1\r\n2\r\n31\r\n1\r\n3\r\n95\r\n80\r\n7\r\n0\r\n10adamja01\r\nKCA\r\nAL\r\n31\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0adamsau02\r\nWAS\r\nNL\r\n2\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0adamsch01\r\nNYA\r\nAL\r\n3\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n\r\nFor the non-baseball people:\r\nAB = At Bats\r\nSH = Sacrifice Bunt\r\nSF = Sacrifice Fly\r\nBB = Base on Balls (walks)\r\nHBP = Hit By Pitch\r\nIBB = Intentional Base on Balls (intentional walks)\r\nSO = Strike Outs\r\nH = Singles\r\nX2H = Doubles\r\nX3H = Triples\r\nHR = Home Runs\r\nThe reason we are pulling extra data points like SH, SF, HBP, & IBB is that in the end, we want Total At Bats. Baseball data is a little tricky in that only some plate appearances are considered an ‘At Bat’. Walks and sacrifices aren’t considered an ‘At Bat’ but for this analysis, we’ll want the total number of times they come to the plate in a season.\r\n\r\n\r\nbatting_2018 <- batting_2018 %>%\r\n  mutate(TBB = BB + IBB + HBP,         # combine all walk types\r\n         TAB = AB + TBB + SH + SF) %>% # create total at-bats\r\n  select(-c(BB, IBB, HBP, SH, SF)) %>% # remove unneeded columns\r\n  select(c(playerID, teamID, lgID, G, TAB, TBB, SO, H, X2B, X3B, HR))\r\n\r\nhead(batting_2018) %>% gt()\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#kqthjgdyqj .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 16px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#kqthjgdyqj .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#kqthjgdyqj .gt_title {\r\n  color: #333333;\r\n  font-size: 125%;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#kqthjgdyqj .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 85%;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#kqthjgdyqj .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#kqthjgdyqj .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#kqthjgdyqj .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#kqthjgdyqj .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#kqthjgdyqj .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#kqthjgdyqj .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#kqthjgdyqj .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#kqthjgdyqj .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#kqthjgdyqj .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#kqthjgdyqj .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#kqthjgdyqj .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#kqthjgdyqj .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#kqthjgdyqj .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#kqthjgdyqj .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#kqthjgdyqj .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#kqthjgdyqj .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#kqthjgdyqj .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#kqthjgdyqj .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#kqthjgdyqj .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#kqthjgdyqj .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#kqthjgdyqj .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#kqthjgdyqj .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#kqthjgdyqj .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#kqthjgdyqj .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#kqthjgdyqj .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#kqthjgdyqj .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#kqthjgdyqj .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#kqthjgdyqj .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#kqthjgdyqj .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#kqthjgdyqj .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#kqthjgdyqj .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nplayerID\r\n      teamID\r\n      lgID\r\n      G\r\n      TAB\r\n      TBB\r\n      SO\r\n      H\r\n      X2B\r\n      X3B\r\n      HR\r\n    abreujo02\r\nCHA\r\nAL\r\n128\r\n560\r\n55\r\n109\r\n132\r\n36\r\n1\r\n22acunaro01\r\nATL\r\nNL\r\n111\r\n489\r\n53\r\n123\r\n127\r\n26\r\n4\r\n26adamewi01\r\nTBA\r\nAL\r\n85\r\n326\r\n35\r\n95\r\n80\r\n7\r\n0\r\n10adamja01\r\nKCA\r\nAL\r\n31\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0adamsau02\r\nWAS\r\nNL\r\n2\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0adamsch01\r\nNYA\r\nAL\r\n3\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n\r\nEDA\r\nLet’s do some EDA on our data:\r\n\r\n\r\nlibrary(DataExplorer)\r\nDataExplorer::profile_missing(batting_2018) %>%\r\n  arrange(desc(num_missing)) %>%\r\n  gt()\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#schhasxwze .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 16px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#schhasxwze .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#schhasxwze .gt_title {\r\n  color: #333333;\r\n  font-size: 125%;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#schhasxwze .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 85%;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#schhasxwze .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#schhasxwze .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#schhasxwze .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#schhasxwze .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#schhasxwze .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#schhasxwze .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#schhasxwze .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#schhasxwze .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#schhasxwze .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#schhasxwze .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#schhasxwze .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#schhasxwze .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#schhasxwze .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#schhasxwze .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#schhasxwze .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#schhasxwze .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#schhasxwze .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#schhasxwze .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#schhasxwze .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#schhasxwze .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#schhasxwze .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#schhasxwze .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#schhasxwze .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#schhasxwze .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#schhasxwze .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#schhasxwze .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#schhasxwze .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#schhasxwze .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#schhasxwze .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#schhasxwze .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#schhasxwze .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nfeature\r\n      num_missing\r\n      pct_missing\r\n    playerID\r\n0\r\n0teamID\r\n0\r\n0lgID\r\n0\r\n0G\r\n0\r\n0TAB\r\n0\r\n0TBB\r\n0\r\n0SO\r\n0\r\n0H\r\n0\r\n0X2B\r\n0\r\n0X3B\r\n0\r\n0HR\r\n0\r\n0\r\n\r\nNo missing data. Let’s look at the distributions:\r\n\r\n\r\nDataExplorer::plot_bar(batting_2018, ncol = 4, nrow = 4)\r\n\r\n\r\n\r\nDataExplorer::plot_histogram(batting_2018, ncol = 4, nrow = 4)\r\n\r\n\r\n\r\n\r\nA LOT of zero values. We need to figure out a good minimum for the number of games played a hitter needs to be included in our analysis. For this, instead of using analysis, I’m going to use business logic and require a player to have at least appeared in 100 games in the 2018 season.\r\n\r\n\r\nbatting_2018 <- batting_2018 %>%\r\n  filter(G >= 100)\r\n\r\n\r\n\r\nLook at the distributions again:\r\n\r\n\r\nDataExplorer::plot_histogram(batting_2018, ncol = 4, nrow = 4)\r\n\r\n\r\n\r\n\r\nMuch better. Most distributions (other than triples) are looking a lot more normal. Triples happen so infrequently that I’m going to combine them with doubles and call them extra-base hits.\r\nIn cluster analysis, it’s important to get all data points on the same scale. If you run the unscaled data through the kmeans algorithm it will potentially over-emphasize a variable that is on a larger scale. In retail this is common. If you have the number of times visited the store and dollars per visit then the kmeans algorithm will over-emphasize dollars per visit because it could potentially be in the hundreds or thousands of dollars while visits are only in the single and double-digit range.\r\nIn this example, we have to take an extra step before we scale. We want to make everything a per-at-bat level. This will let us know the percentage of times a player walks, gets a hit, etc then we will scale each variable. This could also be done for retail data and transforming the data at a per-visit level.\r\n\r\n\r\nbatting_2018 <- batting_2018 %>%\r\n  mutate(XBH = X2B + X3B,\r\n         walks = TBB/TAB,\r\n         strikeouts = SO/TAB,\r\n         singles = H/TAB,\r\n         extras = XBH/TAB,\r\n         triples = X3B/TAB,\r\n         homeruns = HR/TAB) %>%\r\n  mutate(walks_scaled = scale(walks),\r\n         strikeouts_scaled = scale(strikeouts),\r\n         singles_scaled = scale(singles),\r\n         extras_scaled = scale(extras),\r\n         homeruns_scaled = scale(homeruns))\r\n\r\nhead(batting_2018) %>% gt()\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#ewvrkiqtgw .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 16px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#ewvrkiqtgw .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ewvrkiqtgw .gt_title {\r\n  color: #333333;\r\n  font-size: 125%;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#ewvrkiqtgw .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 85%;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#ewvrkiqtgw .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#ewvrkiqtgw .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ewvrkiqtgw .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#ewvrkiqtgw .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#ewvrkiqtgw .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#ewvrkiqtgw .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#ewvrkiqtgw .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#ewvrkiqtgw .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#ewvrkiqtgw .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#ewvrkiqtgw .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#ewvrkiqtgw .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#ewvrkiqtgw .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#ewvrkiqtgw .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#ewvrkiqtgw .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#ewvrkiqtgw .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#ewvrkiqtgw .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#ewvrkiqtgw .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#ewvrkiqtgw .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#ewvrkiqtgw .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#ewvrkiqtgw .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ewvrkiqtgw .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#ewvrkiqtgw .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ewvrkiqtgw .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#ewvrkiqtgw .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#ewvrkiqtgw .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#ewvrkiqtgw .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#ewvrkiqtgw .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#ewvrkiqtgw .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#ewvrkiqtgw .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#ewvrkiqtgw .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#ewvrkiqtgw .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nplayerID\r\n      teamID\r\n      lgID\r\n      G\r\n      TAB\r\n      TBB\r\n      SO\r\n      H\r\n      X2B\r\n      X3B\r\n      HR\r\n      XBH\r\n      walks\r\n      strikeouts\r\n      singles\r\n      extras\r\n      triples\r\n      homeruns\r\n      walks_scaled\r\n      strikeouts_scaled\r\n      singles_scaled\r\n      extras_scaled\r\n      homeruns_scaled\r\n    abreujo02\r\nCHA\r\nAL\r\n128\r\n560\r\n55\r\n109\r\n132\r\n36\r\n1\r\n22\r\n37\r\n0.09821429\r\n0.1946429\r\n0.2357143\r\n0.06607143\r\n0.001785714\r\n0.03928571\r\n-0.1574981\r\n-0.2393866\r\n0.30032062\r\n1.1686432\r\n0.4940999acunaro01\r\nATL\r\nNL\r\n111\r\n489\r\n53\r\n123\r\n127\r\n26\r\n4\r\n26\r\n30\r\n0.10838446\r\n0.2515337\r\n0.2597137\r\n0.06134969\r\n0.008179959\r\n0.05316973\r\n0.1310304\r\n0.7245586\r\n1.20778753\r\n0.7962888\r\n1.4262794adriaeh01\r\nMIN\r\nAL\r\n114\r\n368\r\n27\r\n82\r\n84\r\n23\r\n1\r\n6\r\n24\r\n0.07336957\r\n0.2228261\r\n0.2282609\r\n0.06521739\r\n0.002717391\r\n0.01630435\r\n-0.8623447\r\n0.2381431\r\n0.01849173\r\n1.1012941\r\n-1.0488797aguilje01\r\nMIL\r\nNL\r\n149\r\n569\r\n67\r\n143\r\n135\r\n25\r\n0\r\n35\r\n25\r\n0.11775044\r\n0.2513181\r\n0.2372583\r\n0.04393673\r\n0.000000000\r\n0.06151142\r\n0.3967440\r\n0.7209049\r\n0.35870476\r\n-0.5768913\r\n1.9863443ahmedni01\r\nARI\r\nNL\r\n153\r\n566\r\n44\r\n109\r\n121\r\n33\r\n5\r\n16\r\n38\r\n0.07773852\r\n0.1925795\r\n0.2137809\r\n0.06713781\r\n0.008833922\r\n0.02826855\r\n-0.7383973\r\n-0.2743475\r\n-0.52902478\r\n1.2527376\r\n-0.2455976albieoz01\r\nATL\r\nNL\r\n158\r\n684\r\n41\r\n116\r\n167\r\n40\r\n5\r\n24\r\n45\r\n0.05994152\r\n0.1695906\r\n0.2441520\r\n0.06578947\r\n0.007309942\r\n0.03508772\r\n-1.2432994\r\n-0.6638652\r\n0.61936959\r\n1.1464083\r\n0.2122445\r\n\r\nK-Means Cluster Analysis\r\nWe have the data prepped and scaled so we are ready to run it through the kmeans algorithm. The tricky part of cluster analysis via kmeans is kmeans forces the user to select the number of clusters (k). Our first task is determining k and there are a few ways to do this. The three methods I will showcase is called the elbow method, silhouette scores, and gap statistic.\r\nElbow Method\r\n\r\n\r\nlibrary(factoextra)\r\nfviz_nbclust(select(batting_2018, contains('scaled')), kmeans, method = \"wss\")\r\n\r\n\r\n\r\n\r\nThe elbow method plots the total within sum of square errors. The way kmeans works guarantees that the tot.withinss will always decrease with an increase in clusters. Our goal isn’t to find the lowest tot.withinss but to find the point of diminishing returns or the ‘elbow’ point in the graph. The elbow seems to be at 4 clusters.\r\nSilhouette Method\r\n\r\n\r\nfviz_nbclust(select(batting_2018, contains('scaled')), kmeans, method = \"silhouette\")\r\n\r\n\r\n\r\n\r\nThis method suggests 2 with 3 being close behind.\r\nGap Statistic\r\n\r\n\r\nfviz_nbclust(select(batting_2018, contains('scaled')), kmeans, method = \"gap_stat\")\r\n\r\n\r\n\r\n\r\nThe gap statistic suggests 1 cluster. Unfortunately the methods don’t all agree which is usually the case when doing this analysis out in the wild. Fortunately we can visualize the clusters. We are going to only visualize 3 and 4 clusters because 2 clusters wouldn’t be informative enough to give us any insights.\r\n\r\n\r\nset.seed(123)\r\nk3 <- kmeans(select(batting_2018, contains('scaled')), 3, nstart = 25)\r\nk4 <- kmeans(select(batting_2018, contains('scaled')), 4, nstart = 25)\r\nfviz_cluster(k3, data = select(batting_2018, contains('scaled')))\r\n\r\n\r\n\r\nfviz_cluster(k4, data = select(batting_2018, contains('scaled')))\r\n\r\n\r\n\r\n\r\nNot great separation so it’s understandable that none of the methods agreed on a specific k but I like 4 clusters so we are going to go with that. Let’s join the clusters back to the data and see if we can determine the types of hitters in each cluster. Remember since we scaled the data we are looking at standard scores or z-scores. A z-score of 0 means average for that stat, the more positive means the more above average and vice-versa for negative scores.\r\n\r\n\r\nbatting_2018 %>%\r\n  mutate(cluster = k4$cluster) %>%\r\n  group_by(cluster) %>%\r\n  summarize(n = n(),\r\n         walks = mean(walks_scaled),\r\n         strikeouts = mean(strikeouts_scaled),\r\n         singles = mean(singles_scaled),\r\n         extras = mean(extras_scaled),\r\n         homeruns = mean(homeruns_scaled)) %>%\r\n  gt()\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#xtogdahtyp .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 16px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#xtogdahtyp .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#xtogdahtyp .gt_title {\r\n  color: #333333;\r\n  font-size: 125%;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#xtogdahtyp .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 85%;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#xtogdahtyp .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#xtogdahtyp .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#xtogdahtyp .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#xtogdahtyp .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#xtogdahtyp .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#xtogdahtyp .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#xtogdahtyp .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#xtogdahtyp .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#xtogdahtyp .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#xtogdahtyp .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#xtogdahtyp .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#xtogdahtyp .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#xtogdahtyp .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#xtogdahtyp .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#xtogdahtyp .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#xtogdahtyp .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#xtogdahtyp .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#xtogdahtyp .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#xtogdahtyp .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#xtogdahtyp .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#xtogdahtyp .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#xtogdahtyp .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#xtogdahtyp .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#xtogdahtyp .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#xtogdahtyp .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#xtogdahtyp .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#xtogdahtyp .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#xtogdahtyp .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#xtogdahtyp .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#xtogdahtyp .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#xtogdahtyp .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\ncluster\r\n      n\r\n      walks\r\n      strikeouts\r\n      singles\r\n      extras\r\n      homeruns\r\n    1\r\n39\r\n1.4976302\r\n0.4546602\r\n-0.6094075\r\n-0.55614687\r\n0.941893212\r\n53\r\n-0.2066408\r\n-0.1284540\r\n0.7968028\r\n1.09735051\r\n0.615763323\r\n75\r\n-0.1431369\r\n0.6372036\r\n-0.7537442\r\n-0.49739296\r\n-0.096224734\r\n70\r\n-0.5245764\r\n-0.8387708\r\n0.5438166\r\n0.01192319\r\n-0.88789195\r\n\r\nLet’s visualize these clusters with some bar charts. Might be easier to digest.\r\n\r\n\r\nlibrary(tidyr)\r\nlibrary(ggplot2)\r\nbatting_2018 %>%\r\n  mutate(cluster = k4$cluster) %>%\r\n  group_by(cluster) %>%\r\n  summarize(walks = mean(walks_scaled),\r\n         strikeouts = mean(strikeouts_scaled),\r\n         singles = mean(singles_scaled),\r\n         extras = mean(extras_scaled),\r\n         homeruns = mean(homeruns_scaled),\r\n         .groups = 'drop') %>%\r\n  pivot_longer(!cluster, names_to = \"hitting_category\", values_to = \"z_score\") %>%\r\n  mutate(pos = z_score >= 0) %>%\r\n  ggplot(aes(x = hitting_category, y = z_score, fill = pos)) +\r\n  geom_bar(stat = \"identity\") +\r\n  coord_flip() +\r\n  theme(legend.position = \"none\") +\r\n  facet_wrap(facets = vars(cluster), nrow = 2, ncol = 2)\r\n\r\n\r\n\r\n\r\nCluster 1 = high walks, high strikeouts, low singles, low extras, high homeruns\r\nCluster 2 = low walks, low strikeouts, high singles, high extras, high homeruns\r\nCluster 3 = low walks, highish strikouts, low singles, low extras, low homeruns\r\nCluster 4 = low walks, low strikeouts, high singles, avg extras, low homeruns\r\nLet’s give them names.\r\nCluster 1 = The Three True Outcome Hitters\r\n\r\n\r\nbatting_2018 %>%\r\n  mutate(cluster = k4$cluster) %>%\r\n  group_by(cluster) %>%\r\n  summarize(walks = mean(walks_scaled),\r\n         strikeouts = mean(strikeouts_scaled),\r\n         singles = mean(singles_scaled),\r\n         extras = mean(extras_scaled),\r\n         homeruns = mean(homeruns_scaled),\r\n         .groups = 'drop') %>%\r\n  pivot_longer(!cluster, names_to = \"hitting_category\", values_to = \"z_score\") %>%\r\n  mutate(pos = z_score >= 0) %>%\r\n  filter(cluster == 1) %>%\r\n  ggplot(aes(x = hitting_category, y = z_score, fill = pos)) +\r\n  geom_bar(stat = \"identity\") +\r\n  coord_flip() +\r\n  theme(legend.position = \"none\") +\r\n  ggtitle(label = \"The Three True Outcome Hitters\")\r\n\r\n\r\n\r\n\r\nThese hitters are already known in the baseball world and have been give a name because every at bat results in one of the ‘Three True Outcomes’ which are Walk, Strikeout, Home Run. Examples of this type of hitter is Aaron Judge and Bryce Harper. Let’s see if they ended up in cluster 1.\r\n\r\n\r\n#Aaron Judge, Bryce Harper\r\nbatting_2018 %>%\r\n  mutate(cluster = k4$cluster) %>%\r\n  filter(playerID %in% c(\"judgeaa01\",\"harpebr03\")) %>%\r\n  select(playerID, contains('scaled')) %>%\r\n  pivot_longer(!playerID, names_to = \"hitting_category\", values_to = \"z_score\") %>%\r\n  mutate(pos = z_score >= 0) %>%\r\n  ggplot(aes(x = hitting_category, y = z_score, fill = pos)) +\r\n  geom_bar(stat = \"identity\") +\r\n  coord_flip() +\r\n  theme(legend.position = \"none\") +\r\n  facet_wrap(facets = vars(playerID), nrow = 2, ncol = 2) +\r\n  ggtitle(label = \"Bryce Harper and Aaron Judge\")\r\n\r\n\r\n\r\n\r\nLet’s check the other hitters in this cluster:\r\n\r\n\r\nbatting_2018 %>%\r\n  mutate(cluster = k4$cluster) %>%\r\n  filter(cluster == 1) %>%\r\n  arrange(desc(G)) %>%\r\n  select(playerID, teamID, cluster, contains('scaled')) %>%\r\n  head() %>%\r\n  select(playerID, contains('scaled')) %>%\r\n  pivot_longer(!playerID, names_to = \"hitting_category\", values_to = \"z_score\") %>%\r\n  mutate(pos = z_score >= 0) %>%\r\n  ggplot(aes(x = hitting_category, y = z_score, fill = pos)) +\r\n  geom_bar(stat = \"identity\") +\r\n  coord_flip() +\r\n  theme(legend.position = \"none\") +\r\n  facet_wrap(facets = vars(playerID), nrow = 2, ncol = 3) +\r\n  ggtitle(label = \"The Three True Outcome Hitters\")\r\n\r\n\r\n\r\n\r\nAll of these are pretty good examples of ‘Three True Outcome’ hitters except Carlos Santana (santaca01). His defining attribute is that he draws a ton of walks, but he doesn’t strikeout or hit above average home runs so he is not a great fit for this category. The most likely reason he was put in here is because he fits the walk profile of this group and doesn’t belong in any of the other groups either.\r\nCluster 2 = All Around Good Hitters\r\n\r\n\r\nbatting_2018 %>%\r\n  mutate(cluster = k4$cluster) %>%\r\n  group_by(cluster) %>%\r\n  summarize(walks = mean(walks_scaled),\r\n         strikeouts = mean(strikeouts_scaled),\r\n         singles = mean(singles_scaled),\r\n         extras = mean(extras_scaled),\r\n         homeruns = mean(homeruns_scaled),\r\n         .groups = 'drop') %>%\r\n  pivot_longer(!cluster, names_to = \"hitting_category\", values_to = \"z_score\") %>%\r\n  mutate(pos = z_score >= 0) %>%\r\n  filter(cluster == 2) %>%\r\n  ggplot(aes(x = hitting_category, y = z_score, fill = pos)) +\r\n  geom_bar(stat = \"identity\") +\r\n  coord_flip() +\r\n  theme(legend.position = \"none\") +\r\n  ggtitle(label = \"All Around Good Hitters\")\r\n\r\n\r\n\r\n\r\nThey don’t have a weak area, walk enough, hit a lot of singles and have power by hitting a lot of homeruns. These are the well-rounded great hitters. We would expect the MVP winner Mookie Betts to be in this category. He might well be the most well-rounded hitter in the MLB with almost no weaknesses.\r\n\r\n\r\n#Mookie Betts\r\nbatting_2018 %>%\r\n  mutate(cluster = k4$cluster) %>%\r\n  filter(playerID %in% c(\"bettsmo01\")) %>%\r\n  select(playerID, teamID, cluster, contains('scaled')) %>%\r\n  select(playerID, contains('scaled')) %>%\r\n  pivot_longer(!playerID, names_to = \"hitting_category\", values_to = \"z_score\") %>%\r\n  mutate(pos = z_score >= 0) %>%\r\n  ggplot(aes(x = hitting_category, y = z_score, fill = pos)) +\r\n  geom_bar(stat = \"identity\") +\r\n  coord_flip() +\r\n  theme(legend.position = \"none\") +\r\n  ggtitle(label = \"Mookie Betts\")\r\n\r\n\r\n\r\n\r\nLook at those z-scores for Mookie. Incredible.\r\n\r\n\r\nbatting_2018 %>%\r\n  mutate(cluster = k4$cluster) %>%\r\n  filter(cluster == 2) %>%\r\n  arrange(desc(G)) %>%\r\n  select(playerID, teamID, cluster, contains('scaled')) %>%\r\n  head() %>%\r\n  select(playerID, contains('scaled')) %>%\r\n  pivot_longer(!playerID, names_to = \"hitting_category\", values_to = \"z_score\") %>%\r\n  mutate(pos = z_score >= 0) %>%\r\n  ggplot(aes(x = hitting_category, y = z_score, fill = pos)) +\r\n  geom_bar(stat = \"identity\") +\r\n  coord_flip() +\r\n  theme(legend.position = \"none\") +\r\n  facet_wrap(facets = vars(playerID), nrow = 2, ncol = 3) +\r\n  ggtitle(label = \"All Around Good Hitters\")\r\n\r\n\r\n\r\n\r\nAll of the hitters shown above are great hitters. This is good to see.\r\nCluster 3 = Weak Hitters\r\n\r\n\r\nbatting_2018 %>%\r\n  mutate(cluster = k4$cluster) %>%\r\n  group_by(cluster) %>%\r\n  summarize(walks = mean(walks_scaled),\r\n         strikeouts = mean(strikeouts_scaled),\r\n         singles = mean(singles_scaled),\r\n         extras = mean(extras_scaled),\r\n         homeruns = mean(homeruns_scaled),\r\n         .groups = 'drop') %>%\r\n  pivot_longer(!cluster, names_to = \"hitting_category\", values_to = \"z_score\") %>%\r\n  mutate(pos = z_score >= 0) %>%\r\n  filter(cluster == 3) %>%\r\n  ggplot(aes(x = hitting_category, y = z_score, fill = pos)) +\r\n  geom_bar(stat = \"identity\") +\r\n  coord_flip() +\r\n  theme(legend.position = \"none\") +\r\n  ggtitle(label = \"Weak Hitters\")\r\n\r\n\r\n\r\n\r\nThese batters struggle getting on base (Walks) and strikeout a lot. These are the weak hitters that are most likely at the bottom of the batting order. Most of these names would not be familiar to casual MLB fans.\r\n\r\n\r\nbatting_2018 %>%\r\n  mutate(cluster = k4$cluster) %>%\r\n  filter(cluster == 3) %>%\r\n  arrange(desc(G)) %>%\r\n  select(playerID, teamID, cluster, contains('scaled')) %>%\r\n  head() %>%\r\n  select(playerID, contains('scaled')) %>%\r\n  pivot_longer(!playerID, names_to = \"hitting_category\", values_to = \"z_score\") %>%\r\n  mutate(pos = z_score >= 0) %>%\r\n  ggplot(aes(x = hitting_category, y = z_score, fill = pos)) +\r\n  geom_bar(stat = \"identity\") +\r\n  coord_flip() +\r\n  theme(legend.position = \"none\") +\r\n  facet_wrap(facets = vars(playerID), nrow = 2, ncol = 3) +\r\n  ggtitle(label = \"Weak Hitters\")\r\n\r\n\r\n\r\n\r\nCluster 4 = Balls-in-Play\r\n\r\n\r\nbatting_2018 %>%\r\n  mutate(cluster = k4$cluster) %>%\r\n  group_by(cluster) %>%\r\n  summarize(walks = mean(walks_scaled),\r\n         strikeouts = mean(strikeouts_scaled),\r\n         singles = mean(singles_scaled),\r\n         extras = mean(extras_scaled),\r\n         homeruns = mean(homeruns_scaled),\r\n         .groups = 'drop') %>%\r\n  pivot_longer(!cluster, names_to = \"hitting_category\", values_to = \"z_score\") %>%\r\n  mutate(pos = z_score >= 0) %>%\r\n  filter(cluster == 4) %>%\r\n  ggplot(aes(x = hitting_category, y = z_score, fill = pos)) +\r\n  geom_bar(stat = \"identity\") +\r\n  coord_flip() +\r\n  theme(legend.position = \"none\") +\r\n  ggtitle(label = \"Balls-in-Play\")\r\n\r\n\r\n\r\n\r\nThey don’t walk, they don’t strikeout, and they don’t hit home runs. They just put the ball in play in most at bats.\r\n\r\n\r\nbatting_2018 %>%\r\n  mutate(cluster = k4$cluster) %>%\r\n  filter(cluster == 4) %>%\r\n  arrange(desc(G)) %>%\r\n  select(playerID, teamID, cluster, contains('scaled')) %>%\r\n  head() %>%\r\n  select(playerID, contains('scaled')) %>%\r\n  pivot_longer(!playerID, names_to = \"hitting_category\", values_to = \"z_score\") %>%\r\n  mutate(pos = z_score >= 0) %>%\r\n  ggplot(aes(x = hitting_category, y = z_score, fill = pos)) +\r\n  geom_bar(stat = \"identity\") +\r\n  coord_flip() +\r\n  theme(legend.position = \"none\") +\r\n  facet_wrap(facets = vars(playerID), nrow = 2, ncol = 3) +\r\n  ggtitle(label = \"Balls-in-Play\")\r\n\r\n\r\n\r\n\r\nNick Markakis is a great example of these cluster. He walks slightly above average, almost never strikes out, a ton of singles and extras with well below average home runs.\r\nSummary\r\nWe went through the process of getting the customer data (MLB hitting data), exploring the missing values and distributions, scaling the data, determining an appropriate k using three different methods and then interpreting and validating our segments. The next step is to start using our new-found segments to gain insights on things like roster construction and position importance.\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-06-18-customer-segmentationwith-mlb-players/clusters.png",
    "last_modified": "2021-06-23T22:47:30-05:00",
    "input_file": {},
    "preview_width": 1248,
    "preview_height": 768
  },
  {
    "path": "posts/welcome/",
    "title": "Welcome to The Lob",
    "description": "Welcome to my new blog, The Lob. I plan on using this blog to to explain and practice various data science techniques using sports data.",
    "author": [
      {
        "name": "Louis Oberdiear",
        "url": "thelob.blog/louisoberdiear"
      }
    ],
    "date": "2021-06-07",
    "categories": [],
    "contents": "\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-06-23T19:03:54-05:00",
    "input_file": {}
  }
]
